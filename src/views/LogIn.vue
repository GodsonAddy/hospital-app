<template>
  <div >
    <center>
      <form >
      <md-content class="md-elevation-4">
        <h1> User </h1>
        <md-divider></md-divider>
        <br />
        <div >
          <label for="name">Full Name </label>
          <input 
            type="text" 
            name="name" 
            required id="name" 
            class="form-control" 
            placeholder="Enter your name"
            v-model="name"
          >
        </div>
        <div >
          <label for="password">Card Number</label>
          <input 
            type="password" 
            name="password" 
            class="form-control" 
            required id="password" 
            placeholder="Enter your hospital card number"
            v-model="password"
          >
        </div>
          
        <md-button  class="md-raised md-primary"  v-if="!loading" @click.prevent="SignIn">
          LOGIN
        </md-button>
        <md-button  class="md-raised md-primary" disabled v-if="loading">
          <loading-component></loading-component>
        </md-button>
            
            
      </md-content>
      </form>
    </center>
  
  </div>
</template>

<script>
import LoadingComponent from '@/components/LoadingComponent.vue'

export default {
  name: 'LogIn',
  components: {
    LoadingComponent
  },
  data(){
    return{
      name: "",
      password: "",
      loading: false,
      
    }
  },
  methods:  {
    SignIn() {
      this.loading = true
      this.$axios.post("http://localhost:3000/api/users",{
        name: this.name,
        password: this.password

      })
      .then((res) =>{
        this.loading = false
        this.$router.push({path: "/user"})
        console.log(res)
        
      })
      .catch((err) => {
        this.loading = false
        this.showError()
        console.log(err)
      })
    },
    showError() {
      alert("The name or password typed is wrong")
      
    }
  }, 
  mounted: function () {
    this.SignIn()
  }
}

</script>

<style lang="scss" scoped>
  .md-content {
    width: 400px;
    height: 400px;
    padding: 10px;
    margin: 10px;
  }
  .md-progress-spinner {
    margin: 24px;
  }
  label {
    display: flex;
    align-items: center;
    font-size: 1.125rem;
    margin-bottom: 0.5rem;
  }

  input{
    height: 40px;
    width: 100%;
    border-radius: 0.25rem;
    margin-bottom: 30px;
  }
 
  .form-control:focus {
  border-color: #80bdff;
  outline: 0;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

</style>

